$.extend({initializeProductSlider:function(){var t=$(".product-slider:not(.slick-initialized)"),e=$(".product-slider-navigation:not(.slick-initialized)");if(e.length>0&&e.find(".image").length>0){e.find(".image").length<4&&e.addClass("disable-transform"),e.slick({slidesToShow:4,dots:!1,arrows:!0,vertical:!0,verticalSwiping:!0,asNavFor:".product-slider",swipeToSlide:!0,focusOnSelect:!0,infinite:!0,prevArrow:'<button type="button" class="slick-prev"><i class="fi-xnslxl-chevron-solid"></i></button>',nextArrow:'<button type="button" class="slick-next"><i class="fi-xnsrxl-chevron-solid"></i></button>'})}t.length>0&&t.find(".image").length>0&&t.each(function(){var t=$(this);t.slick({lazyLoad:"anticipated",slidesToShow:1,slidesToScroll:1,dots:t.find(".image").length>1,arrows:t.find(".image").length>1,asNavFor:".product-slider-navigation",focusOnSelect:!1,infinite:!0,prevArrow:'<button type="button" class="slick-prev"><i class="fi-xnslxl-chevron-solid"></i></button>',nextArrow:'<button type="button" class="slick-next"><i class="fi-xnsrxl-chevron-solid"></i></button>'}),t.slickLightbox({itemSelector:"a"})})},setProductDetails:function(t,e){$.showAjaxLoader(),$.ajax({url:"/product/get_product_details",method:"POST",data:e,cache:!1}).done(function(e){"string"==typeof e&&(e=JSON.parse(e)),$.hideAjaxLoader(),0==e.error?(null!=e.gallery_html&&(t.find(".product-gallery").replaceWith(e.gallery_html),$.initializeProductSlider(),$.scrollToTop(t.find(".product-gallery"))),null!=e.prices_html&&t.find(".prices").replaceWith(e.prices_html),null!=e.cart_form_html&&t.find(".product-cart-wrapper").replaceWith(e.cart_form_html),$.loadLazyImages()):$.growl.error({title:e.title?e.title:"",message:e.message?e.message:translations.search_error})})},getProductConfigurableBundleOptions:function(t){if(t.length){var e={};return t.find(".item").each(function(){var t=$(this).data("option-id"),i=$(this).find(".cb-selected").data("pid");e[t]={product_id:i}}),JSON.stringify(e)}},checkDependencies:function(t){t.closest(".configurable-attribute").find(".configurable-attribute-title-value").text(t.attr("title"));var e=t.parents(".configurable-options"),i=t.parents(".configurable-attribute").data("attribute-id"),a=t.data("option-id");e.find("[data-depends-"+i+"]").removeClass("disabled"),e.find("[data-depends-"+i+"]").each(function(){var t=$(this).data("depends-"+i);-1===$.inArray(a,t)&&($(this).addClass("disabled"),$(this).removeClass("active"),$(this).data("option-id")==$(this).parent().data("selected")&&($(this).parent().data("selected",null),$(this).parent().removeData("selected"),$(this).parents(".configurable-attribute").find(".dropdown-open strong").text($(this).parents(".configurable-attribute").data("null-text"))),$.checkDependencies($(this)))})},setConfigurableOptionActive:function(t){if(0===t.length)return!1;t.parents(".configurable-attribute").find('[data-action="configurable-product-set"].active').removeClass("active"),t.addClass("active"),t.parents(".product-information").find('.item-cart.main-cart [name="product_id"]').attr("value",""),$.checkDependencies(t),t.parents(".options").data("selected",t.data("option-id"));var e=t.text();t.parents(".custom-dropdown ").removeClass("active").find(".dropdown-open strong").text(e);window.location.href.split("?")[0];var i=!0;return t.parents(".configurable-options").find(".configurable-attribute").each(function(){0==$(this).find(".option.active").length&&0==$(this).find(".option:not(.disabled)").length?i=!1:0==$(this).find(".option.active").length&&(i=$.setConfigurableOptionActive($(this).find(".option:not(.disabled)").first()))}),i},reloadConfigurableProductDetails:function(t){var e=t.parents(".configurable-options"),i=e.data("pid"),a={},n={},o=window.location.href.split("?")[0];n.pid=i,n.configurable={},e.find(".configurable-attribute").each(function(){n.configurable[$(this).data("attribute-id")]=$(this).find(".options").data("selected")}),a.configurable=n.configurable,window.history.replaceState("","",o+"?"+$.param(a)),n.url=window.location.pathname,$.setProductDetails(t.parents(".product-relative-container"),n)}}),jQuery(document).ready(function(t){var e=t.getUrlParam("qi");e&&e>0&&t.removeUrlParams(),t.initializeProductSlider(),t(document).on("click",".add-to-favorite",function(e){e.preventDefault(),t.productAddToFavorites(t(this))}),t(document).on("click",".add-to-compare",function(e){e.preventDefault(),t.productAddToCompare(t(this).data("pid"),!0,t(this).hasClass("active")?0:1,t(this))});var i={};i.url=window.location.pathname,t(document).on("click",".configurable-bundle-grid .cb-options .dropdown-option",function(){var e=t(this).text(),a=t(this).parents(".item").find(".cb-selected");a.find(".option-value").html(e).removeClass("opacity"),a.find(".cb-remove").removeClass("hidden"),a.data("pid",t(this).data("pid")),t(this).parents(".custom-dropdown").removeClass("active"),i.configurable_bundle=t.getProductConfigurableBundleOptions(t(this).parents(".configurable-bundle-grid")),i.pid=t(this).parents(".configurable-bundle-grid").data("pid"),t.setProductDetails(t(this).parents(".product-relative-container"),i)}),t(document).on("click",".configurable-bundle-grid .cb-remove",function(){var e=t(this).parents(".item").find(".cb-selected");e.find(".option-value").html(e.data("empty")).addClass("opacity"),e.find(".cb-remove").addClass("hidden"),e.data("pid",""),i.configurable_bundle=t.getProductConfigurableBundleOptions(t(this).parents(".configurable-bundle-grid")),i.pid=t(this).parents(".configurable-bundle-grid").data("pid"),t.setProductDetails(t(this).parents(".product-relative-container"),i)}),t(document).on("click",'[data-action="configurable-product-set"]:not(.disabled)',function(){var e=t(this);t.setConfigurableOptionActive(e),t.reloadConfigurableProductDetails(e)}),t(document).on("click","input.bundle-item-select",function(){t.showAjaxLoader();var e=t(this).parents(".bundle-row"),i={};if(i.pid=e.find(".bundle-item-select.main").data("pid"),i.include=[],e.hasClass("single-product-select")){var a=t(this).data("pid");e.find(".bundle-item-select:not(.main):checked").each(function(){t(this).data("pid")!==a&&t(this).prop("checked",!1).parent().removeClass("checked")})}e.find(".bundle-item-select:checked").each(function(){i.include.push(t(this).data("pid"))}),t.showAjaxLoader(),t.ajax({url:"/product/get_bundle_saving_prices",method:"POST",data:i,cache:!1}).done(function(i){t.hideAjaxLoader(),0==i.error?null!=i.savings_html&&e.find(".total-saved").html(i.savings_html):t.growl.error({title:i.title?i.title:"",message:i.message?i.message:translations.search_error})})}),t(document).on("click",".product-bulk-prices .bulk-price",function(){var e=t(this).data("qty"),i=t(this).parents("form");i.find('[name="qty"]').val(e),i.trigger("submit")}),t(document).on("added-to-favorite",function(e,i,a){t.postFavoriteHandler(i)})});
